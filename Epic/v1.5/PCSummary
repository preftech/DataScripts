SELECT DISTINCT 
OP.OR_PROC_ID AS EMR_PREF_CARD_ID,
L.LOC_NAME AS EMR_SURGICAL_AREA, 
SER.PROV_NAME AS EMR_SURGEON, --, EAP.PROC_NAME,
PROCNAME.PROC_NAME AS EMR_PROCEDURE_NAME, 
case when op.INACTIVE_YN = 'Y' then 'N' when op.INACTIVE_YN = 'N' then 'Y' else 'Y' end AS EMR_PREF_CARD_ACTIVE,
--OP.INACTIVE_YN AS EMR_PREF_CARD_ACTIVE, 
SVC.NAME AS EMR_SERVICE_LINE

FROM OR_PROC OP 
JOIN OR_PROC_MOD_SER_INDEX SI ON OP.OR_PROC_ID = SI.OR_PROC_ID
JOIN CLARITY_SER SER ON SI.PMODS_SER_INDEX_ID = SER.PROV_ID
JOIN OR_PROC_MOD_ORP_INDEX ORP ON OP.OR_PROC_ID = ORP.OR_PROC_ID
JOIN OR_PROC PROCNAME ON ORP.PMODS_ORP_INDEX_ID = PROCNAME.OR_PROC_ID
LEFT JOIN OR_PROC_MOD_EAF_INDEX LI ON OP.OR_PROC_ID = LI.OR_PROC_ID
LEFT JOIN CLARITY_LOC L ON LI.PMODS_EAF_INDEX_ID = L.LOC_ID
LEFT JOIN OR_PROC_MOD_SVC_INDEX SVI ON OP.OR_PROC_ID = SVI.OR_PROC_ID
LEFT JOIN ZC_OR_SERVICE SVC ON SVI.PMODS_SVC_INDEX_C = SVC.SERVICE_C

inner join OR_PKLST opk on op.PICKLIST_ID = opk.PICK_LIST_ID
inner join OR_PKLST_SUP_LIST ops on op.PICKLIST_ID = ops.PICK_LIST_ID
inner join OR_SPLY sup on ops.SUPPLY_ID = sup.SUPPLY_ID

LEFT JOIN IDENTITY_SUP_ID ID ON ops.SUPPLY_ID = ID.SUPPLY_ID

WHERE OP.REC_TYP_C = 1
and ID.IDENTITY_ID is not null
